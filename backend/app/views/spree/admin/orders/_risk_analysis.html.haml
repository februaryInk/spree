%fieldset#risk_analysis
  %legend= "#{Spree.t(:risk_analysis)}: #{Spree.t(:not) unless @order.is_risky?} #{Spree.t(:risky)}"
  %table.table.table-condensed.table-bordered
    %thead
      %th= Spree.t('risk')
      %th= Spree.t('status')
    %tbody#risk-analysis.with-border{"data-hook" => "order_details_adjustments"}
      %tr
        %td
          %strong
            = Spree.t(:failed_payment_attempts)
            \:
        %td
          %span{:class => "label label-#{@order.payments.failed.size > 0 ? 'void' : 'complete'}"}
            = link_to "#{Spree.t 'payments_count', count: @order.payments.failed.size, default: pluralize(@order.payments.failed.size, Spree.t(:payment))}", spree.admin_order_payments_path(@order)
      %tr
        %td
          %strong
            = Spree.t(:avs_response)
            \:
        %td
          %span{:class => "label label-#{latest_payment.is_avs_risky? ? 'void' : 'complete'}"}
            - if latest_payment.is_avs_risky?
              = "#{Spree.t(:error)}: #{avs_response_code[latest_payment.avs_response]}"
            - else
              = Spree.t(:success)
      %tr
        %td
          %strong
            = Spree.t(:cvv_response)
            \:
        %td
          %span{:class => "label label-#{latest_payment.is_cvv_risky? ? 'void' : 'complete'}"}
            - if latest_payment.is_cvv_risky?
              = "#{Spree.t(:error)}: #{cvv_response_code[latest_payment.cvv_response_code]}"
            - else
              = Spree.t(:success)
