= render partial: 'spree/admin/users/sidebar', locals: { current: :orders }
= render partial: 'spree/admin/users/user_page_actions'
- content_for :page_title do
  = link_to @user.email, spree.edit_admin_user_url(@user)
  \/
  \#{Spree.t(:"admin.user.order_history")}
%fieldset{"data-hook" => "admin_user_order_history"}
  = paginate @orders
  - if @orders.any?
    %table#listing_orders.table.table-condensed.table-bordered{"data-hook" => ""}
      %thead
        %tr{"data-hook" => "admin_orders_index_headers"}
          %th= sort_link @search, :completed_at,   I18n.t(:completed_at, scope: 'activerecord.attributes.spree/order'), {}, {title: 'orders_completed_at_title'}
          %th= sort_link @search, :number,         I18n.t(:number, scope: 'activerecord.attributes.spree/order'), {}, {title: 'orders_number_title'}
          %th= sort_link @search, :state,          I18n.t(:state, scope: 'activerecord.attributes.spree/order'), {}, {title: 'orders_state_title'}
          %th= sort_link @search, :total,          I18n.t(:total, scope: 'activerecord.attributes.spree/order'), {}, {title: 'orders_total_title'}
      %tbody
        - @orders.each do |order|
          %tr{:class => "state-#{order.state.downcase} #{cycle('odd', 'even')}", "data-hook" => "admin_orders_index_rows"}
            %td.order-completed-at= order_time(order.completed_at) if order.completed_at
            %td.order-number= link_to order.number, edit_admin_order_path(order)
            %td.order-state
              %div{:class => "state #{order.state.downcase}"}= Spree.t("order_state.#{order.state.downcase}")
              - if order.payment_state
                %div{:class => "state #{order.payment_state}"}= link_to Spree.t("payment_states.#{order.payment_state}"), admin_order_payments_path(order)
              - if Spree::Order.checkout_step_names.include?(:delivery) && order.shipment_state
                %div{:class => "state #{order.shipment_state}"}= Spree.t("shipment_states.#{order.shipment_state}")
            %td.order-total= order.display_total.to_html
  - else
    .alert.alert-info.no-objects-found
      = Spree.t(:no_resource_found, resource: plural_resource_name(Spree::Order))
      ,
      \#{link_to Spree.t(:add_one), spree.new_admin_order_path}!
  = paginate @orders
= render 'spree/admin/users/lifetime_stats'
