= render partial: 'spree/admin/users/sidebar', locals: { current: :items }
= render partial: 'spree/admin/users/user_page_actions'
- content_for :page_title do
  = link_to @user.email, spree.edit_admin_user_url(@user)
  \/
  \#{Spree.t(:"admin.user.items_purchased")}
%fieldset{"data-hook" => "admin_user_items_purchased"}
  = paginate @orders
  - if @orders.any?
    %table#listing_items.table.table-condensed.table-bordered.stock-contents{"data-hook" => "stock-contents"}
      %thead
        %th= sort_link @search, :completed_at, I18n.t(:completed_at, scope: 'activerecord.attributes.spree/order'), {}, {title: 'orders_completed_at_title'}
        %th{:colspan => "2"}= Spree.t(:description)
        %th= I18n.t(:price, scope: 'activerecord.attributes.spree/line_item')
        %th= I18n.t(:quantity, scope: 'activerecord.attributes.spree/line_item')
        %th= Spree.t(:total)
        %th= sort_link @search, :state, I18n.t(:state, scope: 'activerecord.attributes.spree/order'), {}, {title: 'orders_state_title'}
        %th= sort_link @search, :number, Spree.t(:order_num, scope: 'admin.user'), {}, {title: 'orders_number_title'}
      %tbody
        - @orders.each do |order|
          - order.line_items.each do |item|
            %tr.stock-item{"data-item-quantity" => "#{item.quantity}"}
              %td.order-completed-at= order_time(order.completed_at) if order.completed_at
              %td.item-image
                = mini_image(item.variant)
              %td.item-name
                = item.name
                %br/
                = "(" + variant_options(item.variant) + ")" unless item.variant.option_values.empty?
                - if item.sku.present?
                  %strong
                    = Spree.t(:sku)
                    \:
                  = item.variant.sku
              %td.item-price= item.single_money.to_html
              %td.item-quantity= item.quantity
              %td.item-total= item.money.to_html
              %td.order-state
                %div{:class => "state #{order.state.downcase}"}= Spree.t("order_state.#{order.state.downcase}")
                - if order.payment_state
                  %div{:class => "state #{order.payment_state}"}= link_to Spree.t("payment_states.#{order.payment_state}"), admin_order_payments_path(order)
                - if Spree::Order.checkout_step_names.include?(:delivery) && order.shipment_state
                  %div{:class => "state #{order.shipment_state}"}= Spree.t("shipment_states.#{order.shipment_state}")
              %td.order-number= link_to order.number, edit_admin_order_url(order)
  - else
    .alert.alert-info.no-objects-found
      = Spree.t(:no_resource_found, resource: plural_resource_name(Spree::Order))
      ,
      \#{link_to Spree.t(:add_one), spree.new_admin_order_path}!
  = paginate @orders
= render 'spree/admin/users/lifetime_stats'
